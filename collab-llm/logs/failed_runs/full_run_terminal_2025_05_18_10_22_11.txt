


[INFO] Task name set to: 20q



  0%|          | 0/1 [00:00<?, ?it/s]*************** answer ****************
 The answer is: Bear.

Processing conversation 74921:   0%|          | 0/20 [00:00<?, ?it/s][Turn 1] **User**: 
/Users/aditi/Documents/multiturn-20q/collab-llm/collabllm/utils/api.py:82: UserWarning: Model gpt-3.5-turbo is not registered. You may still be able to use it.
  warnings.warn(f"Model {model} is not registered. You may still be able to use it.")
/Users/aditi/Documents/multiturn-20q/collab-llm/collabllm/utils/api.py:82: UserWarning: Model gpt-3.5-turbo is not registered. You may still be able to use it.
  warnings.warn(f"Model {model} is not registered. You may still be able to use it.")



DEBUG response type: <class 'dict'>



DEBUG response content:
{
    'current_answer': '',
    'thought': "The assistant has just asked if the hidden word starts with a vowel. Since the target object is 'apple,' I should respond 
accordingly and keep guiding the assistant towards guessing the correct object.",
    'response': 'Yes'
}
[UserSimulator] 'choices'



DEBUG response type: <class 'dict'>



DEBUG response content:
{
    'current_answer': '',
    'thought': "The assistant has just asked if the hidden word starts with a vowel. Since the target object is 'apple', I will respond with 'Yes' 
to guide the assistant in the right direction.",
    'response': 'Yes'
}
[UserSimulator] 'choices'



DEBUG response type: <class 'dict'>



DEBUG response content:
{
    'current_answer': '',
    'thought': "The assistant hasn't guessed the object yet. I need to continue guiding them towards the hidden object.",
    'response': 'No, the hidden word does not start with a vowel.'
}
[UserSimulator] 'choices'



DEBUG response type: <class 'dict'>



DEBUG response content:
{
    'current_answer': '',
    'thought': "The assistant is trying to guess the hidden object, which is 'apple.' They asked if the hidden word starts with a vowel. Since 
'apple' starts with a vowel, I should respond with 'Yes' to guide them in the right direction.",
    'response': 'Yes'
}
[UserSimulator] 'choices'



DEBUG response type: <class 'dict'>



DEBUG response content:
{
    'current_answer': 'apple',
    'thought': "The assistant has just asked if the hidden word starts with a vowel. Since the target object is 'apple' which does not start with a 
vowel, I should respond accordingly.",
    'response': 'No'
}
[UserSimulator] 'choices'



DEBUG response type: <class 'dict'>



DEBUG response content:
{
    'current_answer': '',
    'thought': "The assistant hasn't guessed the object yet. I need to continue guiding them towards guessing 'apple' without revealing it 
directly.",
    'response': 'No'
}
[UserSimulator] 'choices'
> /Users/aditi/Documents/multiturn-20q/collab-llm/collabllm/modules/user_simulator.py(56)__call__()
-> while True:
(Pdb) Processing conversation 74921:   0%|          | 0/20 [01:14<?, ?it/s]
  0%|          | 0/1 [01:27<?, ?it/s]
Traceback (most recent call last):
  File "/Users/aditi/Documents/multiturn-20q/collab-llm/collabllm/core/multithread.py", line 80, in get_multiturn_rewards
    results = list(executor.map(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 619, in result_iterator
    yield _result_or_cancel(fs.pop())
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 317, in _result_or_cancel
    return fut.result(timeout)
           ^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 451, in result
    self._condition.wait(timeout)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditi/Documents/multiturn-20q/collab-llm/scripts/generate_conv_dpo_20q.py", line 359, in <module>
    main()
  File "/Users/aditi/Documents/multiturn-20q/collab-llm/scripts/generate_conv_dpo_20q.py", line 314, in main
    i, convs, pos_responses, neg_responses, chosen_evals, rejected_evals = process_conversation(i, dataset[split], args, assistant_collabllm, assistant_vanilla)
                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditi/Documents/multiturn-20q/collab-llm/scripts/generate_conv_dpo_20q.py", line 160, in process_conversation
    rewards, reward_logs = get_multiturn_rewards(
                           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditi/Documents/multiturn-20q/collab-llm/collabllm/core/multithread.py", line 58, in get_multiturn_rewards
    with concurrent.futures.ThreadPoolExecutor(max_workers=max_workers) as executor:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/_base.py", line 647, in __exit__
    self.shutdown(wait=True)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/concurrent/futures/thread.py", line 239, in shutdown
    t.join()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/threading.py", line 1149, in join
    self._wait_for_tstate_lock()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/threading.py", line 1169, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
